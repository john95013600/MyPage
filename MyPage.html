<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
	<script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
	<style>
		*{
			margin: 0px;
			padding: 0px;
		}
		body,html{
			height: 100%;
		}
		#top-bar{
			width: 100%;
			height: 150px;
			background-color: #F9026B;
		}
		#left-bar{
			width: 20%;
			height: 100%;
			float: left;
			background-color:#8D917D;
		}
		#content{
			width: 80%;
			height: 100%;
			float: left;
			background-color:#aaa;
			text-align:center;
			position: relative;
		}
		#title-h1,#content-h1{
			position: absolute;
			left: 50px;
			top: 20px;
		}
		#content-h1{
			top: 120px;
		}
	</style>
	<script>
	$(function() {
		var link = $("#ad");

		$.ajax({
			url: 'list.php',
			type: 'get',
			dataType: 'html',
		}).done(function(data){
			$("#left-bar").html(data);
			$(".list-content").click(function(){
				var th = $(this);
				var dir = th.parent("ol").attr("id");
				var page = th.attr("id");
				var path = dir+"/"+page;
				console.log(path);
				$.ajax({url:path,
						type:"get",
						dataType:"html",
				}).done(function(data){
					$("#content").html(data);
				});
			});
		});
		$("#btn_save").click(function(){
			// console.log($("#text").val()+","+$("#text").html()+","+$("#text").text());
			var blob = new Blob(["<h1>"+$("#text").val()+"</h1>"],{type:"application/octect-stream"});
			var bloburl = URL.createObjectURL(blob);
			var filename = "save.txt";
			link.attr({href:bloburl,download:filename}).text(filename);
		});
		$("#btn_read").change(function(e){
			var file = e.target.files[0];
			console.log(file);

			var url = URL.createObjectURL(file);
			var tt = $("#text").val()+"<br><img src='"+url+"' style='width:600px; padding:5px 0px'>";
			console.log(tt);
			$("#text").val(tt);
			$("#add").append("<img src='"+url+"' style='width:600px; padding:5px 0px'>");
		});

	});
	</script>
	
</head>
<body>
	<div id="top-bar"><h1>MyPages</h1></div>
	<div id="left-bar">
		<ul>
			<li class="list-dir">Home-Page
				<ol id="Home-Page">
					<li class="list-content" id="Edit">Edit</li>
				</ol>
			</li>
			<li class="list-dir">Daily
				<ol id="Daily">
					<li class="list-content" id="4月">4月</li>
					<li class="list-content" id="5月">5月</li>
				</ol>
			</li>
		</ul>

	</div>
	<div id="content">
		<h1 id="title-h1">標題 :</h1>
		<textarea cols="100" rows="3" id="title" style="margin:20px auto; overflow-x:hidden">標題...</textarea>
		<h1 id="content-h1">內容 :</h1>
		<textarea cols="100" id="text" style="height:300px; margin:20px auto; overflow-x:hidden">打點東西吧...</textarea>
		<br>
		<input id="btn_read" type="file" accept="image/*" value="read">
		<input id="btn_save" type="button" value="save">
		<br>
		<a id="ad"></a>	
		<div id="add" style="width:620px;"></div>
	</div>
</body>
</html>